\parttitletext{
\thispagestyle{empty}
\begin{enumerate}
  \item Вычислительный алгоритм
  {\normalsize
  \begin{itemize}
  	\item Вариационная формулировка
  	\item Конечно-элементная дискретизация
	\end{itemize}
  }
  \item Построение и генерация сеток
  {\normalsize
  \begin{itemize}
  	\item Программа Gmsh
  	\item Процесс создания геометрии
  	\item Создание сетки
  	\item Другие возможности Gmsh
  	\item Ядро OpenCASCADE
	\end{itemize}
  }
  \item Вычислительный пакет FEniCS
  {\normalsize
  \begin{itemize}
  	\item Пакет FEniCS
  	\item Пример работы на Python
  	\item Исследование точности решения
  	\item Пример работы на C++
  	\item Исследование масштабируемости параллельных вычислений
	\end{itemize}
  }  
  \item Постобработка
  {\normalsize
  \begin{itemize}
  	\item Программа Paraview
  	\item Настройка отображения
  	\item Основные фильтры
  	\item Сохранение результатов для отчета
	\end{itemize}
  }  
\end{enumerate} 

}

\part{Алгоритм решения}  

Знакомство с численными методами принято начинать с изучения метода конечных разностей в силу простоты освоения и интуитивной ясности. При изучении метода конечных разностей у начинающего исследователя формируется представление о возможностях численных методов, об их необходимости. Конечные разности позволяют достаточно быстро получить решение задач. Но недостатком полученного решения является то, что оно задано не на всей области, а только в отдельных узлах сетки дискретизации и для получения решения на всей области нужно воспользоваться интерполяцией. Отметим также, что метод конечных разностей имеет отточенный математический аппарат для исследования стабильности, сходимости и аппроксимации решения.

%3.2 - обзор метода конечных объемов преимущества и недостатки
Метод конечных объемов хорошо себя зарекомендовал при аппроксимации решения широкого спектра задач на основе законов сохранения. Метод хорошо справляется с задачами расчета течения, метеорологии, электромагнитов, полупроводников и т.д. Основным преимуществом метода конечных объемов является возможность решения задач на неравномерных, криволинейных и в общем неструктурированных сетках. Недостатком метода можно назвать сложность оценки погрешности решения.

%3.3 - обзор метода конечных элементов преимущества и недостатки
Метод конечных элементов на текущий момент является эталоном численных методов, объединяя в себе научный и инженерные подходы. Благодаря строгому математическому обоснованию метода, практически для любой постановки задачи можно получить оценку аппроксимации решения. Как и конечные объемы конечные элементы могут быть применены на неструктурированной сетке с возможностью измельчения локального размера ячеек в отдельно взятых подобластях. С появлением триангуляции Делоне была решена проблема плохой дискретизации области, которая приводила к повышению погрешности за счет наличия острых углов у отдельных треугольных элементов. Единственным недостатком метода конечных элементов можно назвать сложность реализации, что выражается в потребности больших вычислительных ресурсов. Но и этим недостатком можно пренебречь с учетом современной оптимизации задач под параллельные вычисления и развития технологий центрального и графического процессора.   

%3.4 - обзор метода граничных элементов преимущества и недостатки
Метод граничных элементов заключается в переводе дифференциального уравнения в частных производных к интегральному уравнению на границе. При такой постановке задачи пропадает необходимость дискретизации всей области, достаточно построить сетку только на границе области, что значительно сокращает размер задачи и, соответственно, время расчета. Это преимущество сильнее проявляется в случае когда соотношение размера области к размеру границы велико. Однако стоит учитывать то, что в большинстве случаев матрица системы линейных алгебраических уравнений, к которой сводится решение задачи при использовании метода граничных элементов, является не разреженной, что, в свою очередь, приводит к дополнительной сложности расчета и к соответственному увеличению времени расчета.   

При решении задач с помощью компьютера необходимо иметь представление о вычислительной мощности, которой он обладает. Если взглянуть на историю развития персональных компьютеров, то начальный прогресс шел в сторону повышения тактовой частоты и оптимизации операций за такт. Изначально развитие прогресса шло быстрым темпом, уменьшение тепловыделения за счет уменьшения размеров элементов центрального процессора позволяло из поколения в поколение увеличивать тактовые частоты. Но со временем стало понятно что возможности кристалла кремния приближаются к своему пределу, и дальнейшее увеличение тактовой частоты сопровождалось непропорциональным увеличением тепловыделения и для увеличения производительности процесса нужно было искать другие пути развития. Решением стало применение нескольких ядер на одном процессоре. Публика изначально скептически восприняло подобное нововведение. В начале развития многоядерные процессоры уступали в производительности во многих приложениях. Но с развитием программного обеспечения оптимизированного под многопоточные операции стало понятно, что будущее за параллельными вычислениями. Если посмотреть на рынок современных настольных и мобильных решений, можно заметить, что минимальное количество ядер на одном процессоре равно двум, и со временем это число только растет.

До недавнего времени самыми мощными вычислительными машинами являлись суперкомпьютеры на основе центральных процессоров CPU, таких как \texttt{Intel Xeon}\footnote{\texttt{https://www.intel.ru/content/www/ru/ru/products/processors/xeon.html}}. Подобные решения до сих пор являются лидерами по производительности, если рассматривать общедоступные потребительские технологии. На суперкомпьютерах, построенных на основе CPU, имеются две основные технологии, \texttt{OpenMP}\footnote{\texttt{https://www.openmp.org/}} и \texttt{MPI}\footnote{\texttt{https://www.open-mpi.org/}}. Основной разницей между ними является то, что \texttt{OpenMP} разработана для работы на системе с общей памятью, тогда как \texttt{MPI} -- для работы с распределенной памятью. Если углубиться, OpenMP реализуется следующим образом: главный поток создает множество подчиненных потоков и распределяет задачу между ними. В свою очередь \texttt{MPI(Message Passing Interface)}, как следует из названия, организует параллельные вычисления посредством передачи сообщений между отдельными процессами. В силу возможности работы с распределенной памятью MPI является универсальной и, соответственно, более популярной.

Если рассматривать современный системный блок, то не центральный процессор является самой мощной составляющей системы. Теоретически, графический процессор способен совершить на порядок больше операций с плавающей точкой по сравнению с центральным процессором. Современные фреймворки, такие как \texttt{CUDA}\footnote{\texttt{https://www.nvidia.ru/object/cuda-parallel-computing-ru.html}} и \texttt{OpenCL}\footnote{\texttt{https://ru.wikipedia.org/wiki/OpenCL}}, позволяют использовать эти мощности, не маскируя вычисления под графические задачи. Однако, в силу массивно-параллельной архитектуры графических процессоров, далеко не все прикладные задачи могут использовать все предоставляемые ими вычислительные мощности. Соответственно, задачи, которые будут эффективно реализованы на графическом процессоре, достаточно специфичны.

Одной из важнейших составляющих при работе с численными методами является решение системы линейных алгебраических уравнений (СЛАУ). Ведь все численные методы в итоге сводятся к СЛАУ. Для решения СЛАУ можно воспользоваться специализированными библиотеками, такими как \linebreak \texttt{Trilinos}\footnote{\texttt{https://trilinos.org/}}, \texttt{UMFPACK}\footnote{\texttt{http://faculty.cse.tamu.edu/davis/suitesparse.html}}, \texttt{PETSc}\footnote{\texttt{https://www.mcs.anl.gov/petsc/}}. При выборе подходящей библиотеки необходимо учитывать поддержку библиотекой оптимального итерационного или прямого метода, чтобы получить решение СЛАУ за минимально возможное время.

После выбора библиотеки помимо поддержки методов будет полезно проверить мастшабируемость того или иного решателя. Другими словами, встает вопрос, насколько эффективно можно распараллелить задачу. Конечно, универсального ответа нету, и масштабируемость задачи зависит от разреженности матрицы и используемого предобуславливателя. Ответ на этот вопрос должен быть представлен в виде оптимального метода, использование которого с определенным количеством процессоров выдает решение с заданной точностью за минимальное процессорное время.

Традиционно программная реализация заключается в препроцессинге, основной программы и постпроцессинга. С точки зрения математического моделирования для решения уравнения в частных производных можно выделить следующие шаги:
\begin{itemize}
\item сборка геометрии и генерация сетки;
\item инициализация вариационной постановки задачи;
\item связывание отдельных частей программы;
\item решение и сохранение задачи;
\item визуализация результатов.
\end{itemize}


\chapter{Вычислительный алгоритм} 
Вычислительный алгоритм решения задачи упругости (\ref{eq:equil}) -- (\ref{eq:bouN}) состоит в разрешении уравнения равновесия в перемещениях с использованием численных методов. Рассмотрим решение задачи расчета напряженно-деформиро-\linebreak ванного состояния изотропного линейно-упругого тела с помощью метода конечных элементов.

Уравнение (\ref{eq:equil}) разрешается посредством построения вариационной формулировки задачи с последующей дискретизацией области решения. 
\section{Вариационная формулировка}
Перед построением конечно-элементной аппроксимации уравнения необходимо привести ее к вариационному виду. Для этого определим стандартное гильбертово пространство скалярных функций $L_2(\Omega)$ со скалярным произведением и порожденной нормой в следующем виде
\[
(u, v) = \int_\Omega u(\bm x)v(\bm x)dx, \quad \vert u \vert = (u, u)^{1/2}.
\]
Также определим соответствующее пространство векторных функций\linebreak $\bm L_2(\Omega) = [L_2(\Omega)]^3$. Далее определим гильбертово пространство Соболева $\bm H^1(\Omega)$ векторных функций, необходимого для построения вариационной формулировки уравнения равновесия в перемещениях.

После чего определим пространства тестовых
\[
\bm V = \{ \bm v\in \bm H^1(\Omega) : \bm v(\bm x) = 0,\quad \bm x \in \Gamma_1\}
\] 
и пробных функций
\[
\hat{\bm V} = \{ \bm v\in \bm H^1(\Omega) : \bm v(\bm x) = \bm u_0,\quad \bm x \in \Gamma_1\}.
\] 


Умножив (\ref{eq:equil}) на $\bm v \in \bm V$ и проинтегрировав по частям, с учетом (\ref{eq:strstr}) получим 
\begin{equation}\label{eq:eqvar}
\int_\Omega \bm \sigma (\bm u)\bm \varepsilon(\bm v)dx = 
\int_\Omega \bm\varepsilon(\bm v):\mathbb{C}\bm\varepsilon(\bm u)dx = 
\int_\Omega \bm f \bm v dx + \int_{\Gamma_2}\bm \sigma_n\bm v dx,
\end{equation}
где $\bm u \in \hat{\bm V}$. Отметим, что вариационную формулировку уравнения упругости можно также вывести из функционала энергии.

Разделим полученную постановку на билинейную
\[
a(\bm u, \bm v) = \int_\Omega \bm \sigma (\bm u)\bm \varepsilon(\bm v)dx = \int_\Omega \bm\varepsilon(\bm v):\mathbb{C}\bm\varepsilon(\bm u)dx,
\]
и линейную форму
\[
L(\bm v) = \int_\Omega \bm f \bm v dx + \int_{\Gamma_2}\bm \sigma_n\bm v dx.
\]
Тогда мы получим следующую вариационную формулировку: найти $\bm u \in \hat{\bm V}$, такую что
\begin{equation}\label{eq:varF}
a(\bm u, \bm v) = L(\bm v), \quad \forall \bm v \in \bm V.
\end{equation}

\section{Конечно-элементная дискретизация}
Из рассмотренных численных методов наиболее предпочтительным является метод конечных элементов в силу своей робастности и математической обоснованности. Однако, при дискретизации по времени, практически невозможно обойтись без применения метода конечных разностей. Таким образом, при решении задач представленных в этой работе был использован метод конечных элементов с использованием метода конечных разностей для дискретизации по времени. 

\subsection*{Конечные элементы}
Что касается непосредственно решения задачи расчета напряженно-де- \linebreak формированного состояния тела, отметим особенность, связанную с используемыми конечными элементами. Так как в постановке, которую мы используем, задача решается в перемещениях, и при необходимости тензоры деформации и напряжения вычисляются отдельно. В свою очередь, распределение напряжения вычисляется из полученного решения для перемещения с использованием обобщенного закона Гука и определения тензора деформаций. И так как тензор напряжения линейно пропорционален градиенту вектора перемещений, при расчете напряжения целесообразней использовать конечные элементы имеющие порядок полинома на порядок меньше чем элементы используемые в расчете перемещений.  


\subsection*{Дискретизация}

Для вычислительной реализации задача (\ref{eq:eqvar}) дискретизирована с использованием стандартного метода Галеркина. Пространство $\bm H^1(\Omega)$ заменено конечномерным подпространством $\mathcal{P}$. Если $\bm w_h$ является проекцией $\bm w$ на $\mathcal{P}$, то дискретная задача переписывается следующим образом: найти $\bm u_h \in \mathcal{P}$, такое что $\bm{Mu}_h = \bm w_h$ на $\Gamma_1$ и для всех $\bm v_h \in \mathcal{P}$ c $\bm{Mv}_h = 0$ на $\Gamma_1,$
\begin{equation}
\int_\Omega \bm\varepsilon(\bm v_h):\mathbb{C}\bm\varepsilon(\bm u_h)dx = \int_\Omega\bm f \cdot \bm v_h dx + \int_{\Gamma_2}\bm f\cdot \bm v_h ds.\label{eq:5} 
\end{equation} 
Обозначим через $\mathcal{T}$ триангуляцию области $\Omega$, и пусть $\mathcal{N}$ обозначает множество всех узлов сетки в $\mathcal{T}$; множество $(\bm\eta_1, ..., \bm\eta_{dN}) = (\phi_1\bm e_1, \phi_1\bm e_2, ..., \phi\bm e_d,...,\linebreak \phi_N\bm e_1, \phi_N\bm e_2, ..., \phi_N \bm e_d)$ - узловые базисы конечномерного пространства $\mathcal{P}$, где $N$ -- количество узлов сетки, $d$ -- размерность вектора перемещения и $\phi_z$ - скалярная функция шапочки для узла $z$ в триангуляции $\mathcal{T}$, то есть, $\phi_z(z) = 1$ и $\phi_z(y) = 0$ для всех $y \in \mathcal{N}$ с $y \neq z$. Что касается геометрических граничных условий: мы получаем запись
\begin{equation}
\int_\Omega \bm\varepsilon(\bm\eta_k):\mathbb{C}\bm\varepsilon(\bm u_h)dx = \int_\Omega\bm f\cdot \bm \eta_k dx + \int_{\Gamma_2}\bm f\cdot \bm \eta_k ds \quad (k = 1, ..., dN).\label{eq:6}
\end{equation}
Для дискретного вектора перемещения мы имеем $\bm u_h = \sum_{l=1}^{dN}U_l\bm\eta_l$ и, соответственно (\ref{eq:6}) приводит к линейной системе уравнений
\begin{equation}
\begin{split}
\sum_{l=1}^{dN}\left(\int_\Omega\bm\varepsilon(\bm\eta_k):\mathbb{C}\bm\varepsilon(\bm\eta_l)dx\right)U_l &= \\
= \int_\Omega\bm f\cdot \bm\eta_k dx &+ \int_{\Gamma_2}\bm g\cdot \bm\eta_k ds \quad (k = 1, ..., dN). 
\end{split}
\end{equation}\label{eq:7}
Матрица коэффициентов (глобальная матрица жесткости) $A = (A_{kl}\in\mathbb{R}^{dN\times dN})$ и правая часть $\bm b = (b_k)\in\mathbb{R}^{dN}$ определяются как
\begin{equation}
A_{kl} = \int_\Omega\bm\varepsilon(\bm\eta_k):\mathbb{C}\bm\varepsilon(\bm\eta_l)dx\quad\text{и}\quad b_k = \int_\Omega \bm f\cdot \bm \eta_k dx + \int_{\Gamma_2}\bm g\cdot\bm \eta_k ds.\label{eq:8}
\end{equation}
Матрица коэффициентов является разреженной, симметричной и положительно определенной. 

\vfill
\section*{Задания}
\begin{itemize}
\item[1.] Найдите в литературе определение гильбертова пространства пространства Соболева и конечных элементов Галеркина.
\item[2.] Выведите из уравнения равновесия (\ref{eq:equil}) вариационную формулировку (\ref{eq:eqvar}).
\end{itemize}

