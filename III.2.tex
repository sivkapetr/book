\chapter{Расчет деформации деревянной доски}
Рассматривается численное моделирование задачи линейной упругости анизотропного тела. Приводится вычислительный алгоритм решения стационарной задачи линейной упругости анизотропного тела на примере деформации деревянной доски под действием внутренних напряжений, возникающих при распиловке древесины. При помощи приведенного алгоритма выполняется верификация эмпирически выведенного соотношения для расчета внутренних напряжений Даурской лиственницы.

\section{Постановка задачи}
В этой главе рассматриваются особенности математического моделирования расчета напряженно-деформированного состояния анизотропного тела на примере древесины. Рассматриваемая модель является упрощением относительно общей модели анизотропии, так как делается допущение о том, что древесина является ортотропным материалом. Это допущение упрощает математическое моделирование явления анизотропии, при этом сохраняя общее представление относительно сложностей, возникающих при моделировании анизотропии.

Экспорт пиломатериалов хвойных пород требует разработки технологии лесозаготовки для более эффективной добычи древесины. Проблема оптимизации сырья представляет собой максимизацию объема высококачественных пиломатериалов. В этой главе мы рассмотрим упруго-напряженное состояние древесины. Для численного решения мы аппроксимируем нашу систему с использованием метода конечных элементов. В качестве типовой проблемы мы рассматриваем деформации пиломатериалов под действием внутренних напряжений, которые напрямую влияют на качество сырья. Параметры древесины и модель внутренних напряжений соответствуют Даурской лиственнице, которая составляет большую часть экспорта древесины в Якутии. Представлено численное моделирование трехмерной задачи.

Одним из важнейших факторов влияющих на качество пиломатериалов, и соответственно, на их стоимость -- является технология раскроя древесины. Схемы раскроя древесины напрямую определяют распределение значения внутреннего напряжения древесины, в последствии и деформации, которые являются одним из аспектов качества пиломатериалов. Таким образом, выбор оптимальной схемы раскроя в зависимости от сорта, радиуса древесины, посредством максимизации ценности итогового сырья является важнейшей задачей. На рис. \ref{fig3:ptrn} представлены некоторые примеры схем раскроя древесины.

\begin{figure}[ht]
\begin{center}
\input{figs/part3/pattern}
\end{center}
\caption{Примеры схем раскроя: в развал ($a$), секторная ($b$) и сегментная ($c$)}
\label{fig3:ptrn}
\end{figure}

Для предоставления наиболее робастного метода определения оптимальной схемы раскроя необходимо разработать точную математическую модель, которая может предсказать реальное напряженно-деформированное состояния пиломатериалов. Главной задачей исследования является вычисление максимального значения дугообразного изгиба и изгиба доски в боковом направлении, как вносящих основной вклад в общее значение деформации. Разные типы изгибов доски представлены на рис. \ref{fig3:deftypes}. 

\begin{figure}[ht]
\begin{center}
\input{figs/part3/deftypes}
\end{center}
\caption{Виды изгибов доски: дугообразный изгиб ($a$), изгиб доски в боковом направлении ($b$), коробление доски в поперечном направлении ($c$), кручение ($d$)}
\label{fig3:deftypes}
\end{figure}

Известно, что для каждого сорта дерева имеется уникальная структура и физические параметры, которые существенно отличаются от сорта к сорту. Таким образом, каждый сорт дерева должен описываться отдельной уникальной математической моделью.

В этой главе мы рассматриваем численное решение задачи с использованием математической модели для лиственницы даурской, которая составляет большую часть экспорта древесины Якутии. Лиственница даурская относится к хвойным сортам с выраженной ядровой зоной. Ядровая и заболонная части имеют различные физические и механические характеристики. Это определяет вид и распределение внутреннего напряжения во время роста и последующей обработки дерева.

Одной из главных задач исследования является верификация эмпирически выведенного выражения для расчета распределения внутреннего напряжения посредством численного моделирования. Особенности численного алгоритма проиллюстрированы на примере расчетов трехмерной задачи для пиломатериала из даурской лиственницы.

\section{Математическая модель древесины}

Рассмотрим математическую модель, описывающую напряженно-дефо- \linebreak рмированное состояние в вычислительной области $\Omega$, которая относится к пиломатериалу

\begin{equation}
\label{eq3:ukd}
\begin{split}
\div \bm{\sigma}(\bm u) = 0, \quad \bm{x} \in \Omega,
\end{split}
\end{equation}
где $\bm{x} = (x_1, x_2, x_3)$ вектор координат. Оси координатной системы задаются таким образом, чтобы каждая ось была параллельна одной стороне доски. 

Добавим также соотношение между тензором напряжений $\bm{\sigma}$ и тензором деформации $\bm{\varepsilon}$, которое, в случае дерева, описывается как для ортотропного тела в локально повернутой системе координат ($r, t, a$)
\begin{equation}
\label{eq3:system}
\begin{split}
\varepsilon_r &= \frac{\sigma_r}{E_r} - \frac{\mu_{tr}\sigma_t}{E_t}  - \frac{\mu_{ar}\sigma_a}{E_a},\\
\varepsilon_t &= -\frac{\mu_{rt}\sigma_r}{E_r} + \frac{\sigma_t}{E_t}  - \frac{\mu_{at}\sigma_a}{E_a},\\
\varepsilon_a &= -\frac{\mu_{ra}\sigma_r}{E_r} - \frac{\mu_{ta}\sigma_t}{E_t}  + \frac{\sigma_a}{E_a},\\
\gamma_{rt} &= \frac{\tau_{rt}}{G_{rt}}, \quad \gamma_{ra} = \frac{\tau_{ra}}{G_{ra}}, \quad \gamma_{ta} = \frac{\tau_{ta}}{G_{ta}},
\end{split}
\end{equation}
где $E_r, E_t, E_a$ - радиальный, тангенциальный и продольный модуль Юнга, $G_{ij}, \mu_{ij}$ - модули сдвига и коэффициенты Пуассона, соответственно. Таким образом, для ортопропного тела определяется целых 12 упругих постоянных вместо 2 для изотропного.

Для удобства записи система уравнений (\ref{eq3:system}) может быть переписана в обозначениях Фойгта:
\[
\begin{split}
\bm{\sigma}(\bm{x}) = \mathbb{C} \bm{\varepsilon}(\bm{x})
\end{split}
\]
где
\[
\mathbb{C} = \begin{bmatrix} C_{11} & C_{12} & C_{13} & 0 & 0 & 0 \\ C_{21} & C_{22} & C_{23} & 0 & 0 & 0 \\ C_{31} & C_{32} & C_{33} & 0 & 0 & 0 \\ 0 & 0 & 0 & C_{44} & 0 & 0 \\ 0 & 0 & 0 & 0 & C_{55} & 0 \\ 0 & 0 & 0 & 0 & 0 & C_{66}  \end{bmatrix}
\]
является симметричной матрицей со следующими компонентами
\begin{align*}
C_{11} &= \frac{1 - \mu_{at}\mu_{ta}}{\Delta E_t E_a}, & C_{22} &= \frac{1 - \mu_{ar}\mu_{ra}}{\Delta E_r E_a}, & C_{33} &= \frac{1 - \mu_{rt}\mu_{tr}}{\Delta E_r E_t}, \\
C_{12} &= \frac{\mu_{tr} + \mu_{ar}\mu_{ta}}{\Delta E_t E_a}, &
C_{13} &= \frac{\mu_{ar} + \mu_{tr}\mu_{at}}{\Delta E_t E_a}, &
C_{23} &= \frac{\mu_{at} + \mu_{rt}\mu_{ar}}{\Delta E_r E_a}, \\
C_{44} &= G_{rt}, &
C_{55} &= G_{ra}, &
C_{66} &= G_{ta},
\end{align*}

здесь $\Delta$ -- вспомогательный коэффициент, используемый для сокращения записи, который выражается как
\[
\Delta = \frac{1 - \mu_{rt}\mu_{tr} - \mu_{ra}\mu_{ar} - \mu_{ta}\mu_{at} - 2\mu_{tr}\mu_{at}\mu_{ra}}{E_rE_tE_a}.
\]
Для того, чтобы выполнить вычисления с использованием векторов из декартовой системы координат, нам нужно преобразовать тензор деформации вычисленный из вектора перемещений $\bm{u} = (u_1, u_2, u_3)$ 
\[
\bm \varepsilon (\bm u) = \frac{1}{2}(\grad \bm u + \grad^T \bm u),
\]
используя для каждой точки матрицу перехода, вычисляемый следующим образом 
\[
\bm{R} = \begin{bmatrix} \cos(\alpha) & -\sin(\alpha) & 0 \\ \sin(\alpha) & \cos(\alpha) & 0 \\
0 & 0 & 1  \end{bmatrix}
\]
здесь $\displaystyle{\cos(\alpha) = \frac{x_1}{r}}$ и $\displaystyle{\sin(\alpha) = \frac{x_2}{r}}$.

Этот поворот проиллюстрирован в плоскости, образуемом векторами $r-t$ на рис. \ref{fig3:cs}. 

\begin{figure}[ht]
\begin{center}
\input{figs/part3/rotation}
\end{center}
\caption{Декартова и локальная преобразованная системы координат в плоскости образуемом векторами $r-t$}
\label{fig3:cs}
\end{figure}

Дополним задачу граничными условиями, отвечающими за поверхностные напряжения и фиксирование по перемещениям. В частности, отметим граничное условие второго рода
\begin{equation}
\label{eq3:gun}
\begin{split}
(\bm{\sigma} \cdot \bm{n})(\bm{x}) = \bm{\sigma_n} (\bm{x}), \quad \bm{x} \in \Gamma_2,
\end{split}
\end{equation}
которое определяет распределение внутренних напряжений по всей поверхности пиломатериала. Таким образом, мы имеем дело с чистой задачей Неймана (Pure Neumann problem), для решения которого мы задаем следующие граничные условия первого рода на трех точках
\begin{equation}
\label{eq3:gud}
\begin{split}
\bm{u} (\bm{x}) = \bm{0}, \quad \bm{x} \in \Gamma_1,
\end{split}
\end{equation}
которые определяют фиксацию трех определенных точек по 1, 2 и всем осям, соответственно. Такое фиксирование помогает получить единственное решение, убрав случайный сдвиг тела. При этом эти условия не представляют помехи для возникновения любого описанного ранее вида деформации.

\section{Объект исследования}

Объектом исследования является деревянная доска из даурской лиственницы с размерами $156\text{мм}\times 54\text{мм}\times 5 \text{м}$. Дерево из которого была выпилена доска моделируется в виде коноида. Для даурской лиственницы мы используем параметры представленные в табл. \ref{tab3:coef}

Согласно исследованиям В. Н. Глухих, для даурской лиственницы была представлена следующая модель, описывающая распределение внутреннего напряжения
\[
\begin{split}
\sigma_r(r) &= \sigma_{ta}\ln\left(\frac{r}{R}\right),\\
\sigma_t(r) &= \sigma_{ta}\left(1+\ln\left(\frac{r}{R}\right)\right),\\
\sigma_a(r) &= \sigma_{0}\left(1-7\frac{r}{R}-8\frac{r^{14}}{R^{14}}\right).
\end{split}
\]
Здесь $\sigma_{ta}, \sigma_{0}$ - вспомогательные коэффициенты, имеющие определенный порядок, которые еще предстоит выяснить, $r = \sqrt{x_1^2 + x_2^2}$ - радиус определенной точки на поверхности и $R$ - радиус дерева, который зависит от значения $x_{3}$. При $x_3 = 0$ мы имеем $R(0) = R_1$ и $R(5) = R_2$ на двух концах пиломатериала.


\begin{table}[ht]
\begin{center}
\begin{tabular}{l|l|l}
\hline
\multicolumn{3}{l}{\textbf{Модуль упругости}} \\
\hline\noalign{\smallskip}
$E_r,$ ГПа & $E_t,$ ГПа & $E_a,$ ГПа \\  
\hline\noalign{\smallskip}
0.7 & 0.35 & 11 \\  
\hline
\multicolumn{3}{l}{\textbf{Модуль сдвига}}\\
\hline
$G_{rt}$, ГПа& $G_{ar}$, ГПа& $G_{at}$, ГПа \\
0.33 & 1.14 & 0.71 \\
\hline
\multicolumn{3}{l}{\textbf{Коэффициент Пуассона}}\\
\hline
$\mu_{tr}$ & $\mu_{ar}$ & $\mu_{ta}$ \\
0.62 & 0.56 & 0.035\\
\hline
\end{tabular}
\caption{Приближенные упругие параметры даурской лиственницы}
\label{tab3:coef}
\end{center}
\end{table} 

Как говорилось ранее, для получения однозначного решения задачи Неймана без случайных смещений, необходимо добавить граничные условие первого рода, которые отвечают за фиксацию трех отдельных точек геометрии по определенным осям. Подобное фиксирование хорошо тем, что обеспечивает единственность решения и не мешает телу деформироваться в трех отдельных осях. Геометрия доски, точки фиксации и оси представлены на рис. \ref{fig3:geo}

\begin{figure}[ht]
\begin{center}
\input{figs/part3/geometry}
\end{center}
\caption{Геометрия доски с представленными точками фиксирования}
\label{fig3:geo}
\end{figure}

Точка 1 закреплена по всем трем осям. Точка 2 не может перемещаться по оси $x_2$, и точка 3 зафиксирована по осям $x_1$ и $x_2$.

\section{Численное решение}

Для вычислительной реализации описанной математической модели с использованием представленных параметров упругости был использован следующий ufl файл
\begin{lstlisting}
cell = tetrahedron
element = VectorElement("Lagrange", cell, 2)

u = TrialFunction(element)
v = TestFunction(element)

x = cell.x
n = cell.n
h = Constant(cell)
d = Constant(cell)
r1 = Constant(cell)
r2 = Constant(cell)

sigma_ta = Constant(cell)
sigma_0 = Constant(cell)

#Coefficients
E_a = 11e9 
E_r = 0.7e9
E_t = 0.35e9
G_ar = 1.14e9
G_at = 0.71e9
G_rt = 0.33e9
mu_tr = 0.62
mu_rt = 1.24
mu_at = 1.1
mu_ta = 0.035
mu_ra = 0.036
mu_ar = 0.56

#Elastic tensor elements
D = (1 - mu_tr*mu_rt - mu_at*mu_ta - mu_ra*mu_ar \ 
- 2*mu_tr*mu_ra*mu_at)/(E_a*E_t*E_r)
C_11 = (1 - mu_at*mu_ta)/(D*E_a*E_t)
C_22 = (1 - mu_ar*mu_ra)/(D*E_a*E_r)
C_33 = (1 - mu_tr*mu_rt)/(D*E_r*E_t)
C_12 = (mu_tr + mu_ar*mu_ta)/(D*E_a*E_t)
C_13 = (mu_ar + mu_tr*mu_at)/(D*E_a*E_t)
C_23 = (mu_at + mu_rt*mu_ar)/(D*E_r*E_a)
C_44 = G_rt
C_55 = G_ar
C_66 = G_at

def epsilon(v):
    return 0.5*(grad(v) + grad(v).T)

def cosx(x): 
    return ((x[0]-h)/sqrt((x[0]-h)**2+(x[1]+d)**2))

def sinx(x): 
    return ((x[1]+d)/sqrt((x[0]-h)**2+(x[1]+d)**2))

def transx(x):
    return as_matrix([[cosx(x), -sinx(x), 0],
                      [sinx(x),  cosx(x), 0],
                      [      0,        0, 1]])

def eps(u, x, h, d):
    return as_vector([(u[0].dx(0)*(x[0]-h)*(x[0]-h) + (u[0].dx(1)\
           + u[1].dx(0))*(x[0]-h)*(x[1]+d)\ u[1].dx(1)*(x[1]+d)\
           *(x[1]+d))/((x[0]-h)*(x[0]-h)+(x[1]+d)*(x[1]+d)),
           (u[0].dx(0)*(x[1]+d)*(x[1]+d) - (u[0].dx(1) + \
           u[1].dx(0))*(x[0]-h)*(x[1]+d) + u[1].dx(1)*(x[0]-h)\
           *(x[0]-h))/((x[0]-h)*(x[0]-h)+(x[1]+d)*(x[1]+d)),
           (u[2].dx(2)),
           (-u[0].dx(0)*(x[0]-h)*(x[1]+d) + (u[0].dx(1)\
           + u[1].dx(0))/2*((x[0]-h)*(x[0]-h) - (x[1]+d)*(x[1]+d))\
           + u[1].dx(1)*(x[0]-h)*(x[1]+d))/((x[0]-h)\
           * (x[0]-h)+(x[1]+d)*(x[1]+d)),
           ((u[0].dx(2) + u[2].dx(0))/2*(x[0]-h) + (u[1].dx(2)\
           + u[2].dx(1))/2*(x[1]+d))/sqrt((x[0]-h)*(x[0]-h)\
           +(x[1]+d)*(x[1]+d)),
           (-(u[0].dx(2) + u[2].dx(0))/2*(x[1]+d) + (u[1].dx(2)\
           + u[2].dx(1))/2*(x[0]-h))/sqrt((x[0]-h)*(x[0]-h)\
           +(x[1]+d)*(x[1]+d))])

def elas(C_11, C_22, C_33, C_12, C_13, C_23, C_44, C_55, C_66):
    return as_matrix([[C_11, C_12, C_13,    0,    0,    0], 
                      [C_12, C_22, C_23,    0,    0,    0], 
                      [C_13, C_23, C_33,    0,    0,    0], 
                      [   0,    0,    0, C_44,    0,    0],
                      [   0,    0,    0,    0, C_55,    0],
                      [   0,    0,    0,    0,    0, C_66]])

def instrx(x, h, d, r1, r2):
    return as_matrix([[-sigma_ta*ln(sqrt((x[0]-h)*(x[0]-h)\
    + (x[1]+d)*(x[1]+d))/(r1+(r2-r1)/5*x[2])), 0, 0],
                      [0, -sigma_ta*(1+ln(sqrt((x[0]-h)*(x[0]-h)\
    + (x[1]+d)*(x[1]+d))/(r1+(r2-r1)/5*x[2]))), 0],
                      [0, 0, sigma_0*(1-8*((x[0]-h)*(x[0]-h)\
    + (x[1]+d)*(x[1]+d))**7/((r1+(r2-r1)/5*x[2])**14)\
    -7*sqrt((x[0]-h)*(x[0]-h) + (x[1]+d)*(x[1]+d))\
    /(r1+(r2-r1)/5*x[2]))]]) 

def instr(x, h, d, r1, r2):
    return transx(x)*instrx(x, h, d, r1, r2)*transx(x).T

a = inner(eps(v, x, h, d), dot(elas(C_11, C_22, C_33, C_12,\
          C_13, C_23, C_44, C_55, C_66), eps(u, x, h, d)))*dx
L = inner(v, dot(instr(x, h, d, r1, r2), n))*ds

element_s = TensorElement("Discontinuous Lagrange", cell, 0)
s = TrialFunction(element_s)
w      = TestFunction(element_s)
disp   = Coefficient(element)
def sigma1(v):
    return 2.0*mu1*epsilon(v) +\
           lmbda1*tr(epsilon(v))*Identity(v.cell().d)

a_s = inner(s, w)*dx
L_s = inner(sigma1(disp), w)*dx

forms = [a, L, a_s, L_s]
\end{lstlisting}
Здесь функция \texttt{instrx} определяет напряжения роста древесины, которые высвобождаются при распилке. Большую часть кода занимает перевод системы координат с цилиндрической на декартовую.

Заметим, что запись для тензора деформации можно было сократить с использованием матриц перехода. Однако такая реализация требует дополнительных вычислений, что приводит к значительному увеличению времени расчета напряженно-деформированного состояния.


\subsection*{Пример решения}
В качестве примера численного решения задачи мы рассмотрим деформацию доски, расположение которой внутри дерева было параллельно оси роста дерева, то есть оси $a$ и $x_3$ совпадают. Положение доски внутри дерева в плоскости $r-t$ показано на рис. \ref{fig3:incirc}.

\begin{figure}[ht]
\begin{center}
\input{figs/part3/location}
\end{center}
\caption{Положение доски внутри дерева в плоскости $r-t$}
\label{fig3:incirc}
\end{figure}

Для расчетов мы использовали приближенные по порядку значения $\sigma_0 = 2$ МПа и $\sigma_{ta} = 0.1$ МПа. Вычисления были проведены с использованием сетки, представленной на рис. \ref{fig3:mesh}, размеры ячеек которой являются оптимальными для получения достаточно точных результатов.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.7\linewidth]{figs/part3/mesh.png}
\end{center}
\caption{Трехмерный и боковой вид вычислительной сетки (1377 вершин, 7560 элементов)}
\label{fig3:mesh}
\end{figure}

При таких значениях было получено распределение перемещения, показанное на рис. \ref{fig3:res}

\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.6\linewidth]{figs/part3/disp.png}
\end{center}
\caption{Распределение величины вектора перемещения. Фигура деформирована с увеличенным значением перемещения в $10$ раз}
\label{fig3:res}
\end{figure}

Как было показано, при расположении доски, показанной на рис. \ref{fig3:res}, мы получили большое значение дугообразного и бокового изгиба. Эти значения согласно ГОСТу 26002-83 относятся к 5ой категории пиломатериалов и такая древесина не представляет большой ценности, и, вероятно, не будет экспортироваться. Другие виды деформации, а именно кручение и коробление в поперечном направлении едва заметны.


\newpage
\vfill
\section*{Заключение}

\begin{itemize}
\item На примере численного расчета деформаций деревянной доски приведен вычислительный алгоритм задачи линейной упругости анизотропного тела.
\item В результате верификации эмпирически выведенной формулы для внутренних напряжений при типичных значениях параметров получено адекватное значение дугообразного изгиба.
\end{itemize}

